<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CrossmintVault</title>
    <link rel="stylesheet" href="css/styles.css">
    <!-- For production use: -->
    <script src="dist/bundle.min.js"></script>
    
    <!-- For development use (uncomment when debugging): -->
    <!-- <script src="dist/bundle.js"></script> -->
    
    <!-- Environment configuration -->
    <script>
        window.ENV = {
            API_URL: "http://localhost:3000/api",
            ENVIRONMENT: "development",
            APP_VERSION: "1.0.0",
            THEME: "default",
            STORAGE_PREFIX: "crossmint-signers"
        };
    </script>
</head>
<body>
    <div class="container">
        <h1>CrossmintVault</h1>
        <div class="status" id="status">Initialized...</div>
        
        <div class="demo-section">
            <h2>Events Demo</h2>
            
            <div class="event-box">
                <div class="event-box-header">
                    <h3>Event Log</h3>
                    <button class="clear-events" id="clear-events">Clear</button>
                </div>
                <div class="event-box-body" id="event-log">
                    <div class="event-item event-info">Waiting for events...</div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="footer">
        Crossmint Vault | <span class="version">v1.0.0</span>
    </div>

    <!-- Initialize demo -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize the XMIF framework
            if (window.XMIF) {
                window.XMIF.init({
                    environment: window.ENV.ENVIRONMENT,
                    apiUrl: window.ENV.API_URL,
                    storagePrefix: window.ENV.STORAGE_PREFIX
                })
                .then(() => {
                    console.log('XMIF framework initialized');
                    document.getElementById('status').textContent = 'Ready';
                    
                    // Set up event logging
                    setupEventLog();
                })
                .catch(err => {
                    console.error('Failed to initialize XMIF:', err);
                    document.getElementById('status').textContent = `Error: ${err.message}`;
                    logEvent('Error', err.message ?? (typeof err === 'string' ? err : 'Unknown error'), true);
                });
            } else {
                document.getElementById('status').textContent = 'Error: XMIF not loaded';
                logEvent('Error', 'XMIF framework not loaded', true);
            }
            
            // Set up event logging system
            function setupEventLog() {
                // Clear events button
                document.getElementById('clear-events').addEventListener('click', () => {
                    document.getElementById('event-log').innerHTML = '';
                    logEvent('Info', 'Event log cleared');
                });
            }
            
            // Log an event to the event box
            function logEvent(type, message, isError = false) {
                const eventLog = document.getElementById('event-log');
                const eventItem = document.createElement('div');
                
                let className = 'event-item ';
                if (isError) {
                    className += 'event-error';
                } else if (type === 'Storage') {
                    className += 'event-incoming';
                } else {
                    className += 'event-info';
                }
                
                eventItem.className = className;
                
                const timestamp = new Date().toLocaleTimeString();
                eventItem.innerHTML = `<strong>${timestamp} - ${type}:</strong> ${message}`;
                
                // Add to the top 
                if (eventLog.firstChild) {
                    eventLog.insertBefore(eventItem, eventLog.firstChild);
                } else {
                    eventLog.appendChild(eventItem);
                }
                
                // Remove first message if it's "Waiting for events..."
                const firstItem = eventLog.querySelector('.event-item');
                if (firstItem && firstItem.textContent.includes('Waiting for events...')) {
                    eventLog.removeChild(firstItem);
                }
            }
        });
    </script>
</body>
</html> 